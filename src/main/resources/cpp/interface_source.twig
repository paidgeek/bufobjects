{%- set name = definition.name.simpleName -%}

{% set fields = definition.fields %}
{% for p in definition.parentPath -%}
  {% set fields = merge(fields, p.fields) %}
{%- endfor -%}

{% for p in definition.name.path %}
  {% if (loop.revindex0 != 0) %}
    namespace {{ lower(p) }} {
  {% endif %}
{% endfor %}

{{ name }}::{{ name }}() : _cached_size_(0) { }

{{ name }}::{{ name }}(
{%- for field in fields -%}
      {{ trim(macros.getTypeName(utils, field.type)) }} {{ utils.toSnakeCase(field.name) }}
  {%- if (loop.revindex0 != 0) -%}
    ,
  {%- endif -%}
{%- endfor -%})
: {%- if (definition.parent is not null) -%}
  {{ trim(macros.getBaseNoPointer(utils, definition.parentDefinition)) }}(
  {%- for field in definition.parentDefinition.fields -%}
    {{ utils.toSnakeCase(field.name) }}
    {%- if (loop.revindex0 != 0) -%}
      ,
    {%- endif -%}
  {%- endfor -%}
  )
  {% if (length(definition.fields) != 0) %}
    ,
  {% endif %}
{%- endif %}
{%- for field in definition.fields -%}
  {%- if(utils.getClassName(field.type.definition) == "ClassDefinition" or utils.getClassName(field.type.definition) == "InterfaceDefinition") -%}
    {{ utils.toClassFieldName(field.name) }}(std::move({{ utils.toSnakeCase(field.name) }}))
  {%- else -%}
    {{ utils.toClassFieldName(field.name) }}({{ utils.toSnakeCase(field.name) }})
  {%- endif -%}
  {%- if (loop.revindex0 != 0 ) -%}
    ,
  {%- endif -%}
{%- endfor -%}
{
  _cached_size_ = 0;
}

uint32_t {{ name }}::Size() const {
  if (_cached_size_ != 0) {
    return _cached_size_;
  }
  {% include "/cpp/class/size.twig" %}
  return _cached_size_;
}

void {{ name }}::Clear() {
{% include "/cpp/class/clear.twig" %}
_cached_size_ = 0;
}

{% for p in definition.name.path %}
  {% if (loop.revindex0 != 0) %}
    }
  {% endif %}
{% endfor %}
